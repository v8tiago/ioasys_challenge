# Desafio Pessoa Desenvolvedora Java

## üèó O que fazer?

- Voc√™ deve realizar um *fork* deste reposit√≥rio e, ao finalizar, enviar o link do seu reposit√≥rio para a nossa equipe.
  Lembre-se, **N√ÉO** √© necess√°rio criar um *Pull Request* para isso, n√≥s iremos avaliar e retornar por e-mail o
  resultado do teste

# üö® Requisitos

- A API deve ser constru√≠da em Java (8 ou superior) utilizando Spring Framework (2.2 ou superior)
- Implementar autentica√ß√£o seguindo o padr√£o ***JWT***, lembrando que o token a ser recebido deve estar no formado ***
  Bearer***
- Implementar opera√ß√µes no banco de dados utilizando ***Spring Data JPA*** & ***Hibernate***
- **Bancos relacionais permitidos**
    - *MySQL* (prioritariamente)
    - *PostgreSQL*
- As entidades devers√£o ser criadas como tabelas utilizando a ferramenta de migra√ß√£o **Flyway**. Portanto, os scripts
  de **migrations** para gera√ß√£o das tabelas devem ser enviados no teste
- Sua API dever√° seguir os padr√µes REST na constru√ß√£o das rotas e retornos
- Sua API dever√° conter documenta√ß√£o viva utilizando a *OpenAPI Specification* (**Swagger**)
- Caso haja alguma particularidade de implementa√ß√£o, instru√ß√µes para execu√ß√£o do projeto dever√£o ser enviadas

# üéÅ Extra

- Testes unit√°rios
- Teste de integra√ß√£o da API em linguagem de sua prefer√™ncia (damos import√¢ncia para pir√¢mide de testes)
- Cobertura de testes utilizando Sonarqube
- Utiliza√ß√£o de *Docker* (enviar todos os arquivos e instru√ß√µes necess√°rias para execu√ß√£o do projeto)

# üïµüèª‚Äç‚ôÇÔ∏è Itens a serem avaliados

- Estrutura do projeto
- Utiliza√ß√£o de c√≥digo limpo e princ√≠pios **SOLID**
- Seguran√ßa da API, como autentica√ß√£o, senhas salvas no banco, *SQL Injection* e outros
- Boas pr√°ticas da Linguagem/Framework
- Seu projeto dever√° seguir tudo o que foi exigido na se√ß√£o  [O que desenvolver?](##--o-que-desenvolver)

# üñ• O que desenvolver?

Voc√™ dever√° criar uma API que o site [IMDb](https://www.imdb.com/) ir√° consultar para exibir seu conte√∫do, sua API
dever√° conter as seguintes funcionalidades:

- Administrador
    - Cadastro
    - Edi√ß√£o
    - Exclus√£o l√≥gica (desativa√ß√£o)
    - Listagem de usu√°rios n√£o administradores ativos
        - Op√ß√£o de trazer registros paginados
        - Retornar usu√°rios por ordem alfab√©tica
- Usu√°rio
    - Cadastro
    - Edi√ß√£o
    - Exclus√£o l√≥gica (desativa√ß√£o)
- Filmes
    - Cadastro (somente um usu√°rio administrador poder√° realizar esse cadastro)
    - Voto (a contagem de votos ser√° feita por usu√°rio de 0-4 que indica quanto o usu√°rio gostou do filme)
    - Listagem
        - Op√ß√£o de filtros por diretor, nome, g√™nero e/ou atores
        - Op√ß√£o de trazer registros paginados
        - Retornar a lista ordenada por filmes mais votados e por ordem alfab√©tica
    - Detalhes do filme trazendo todas as informa√ß√µes sobre o filme, inclusive a m√©dia dos votos

**Obs.:**

**Apenas os usu√°rios poder√£o votar nos filmes e a API dever√° validar quem √© o usu√°rio que est√° acessando, ou seja, se √©
um usu√°rio administrador ou n√£o.**

**Caso n√£o consiga concluir todos os itens propostos, √© importante que nos envie a implementa√ß√£o at√© onde foi poss√≠vel
para que possamos avaliar**

# Adendo

## Iniciando

Com essas instru√ß√µes ser√° poss√≠vel executar esse projeto na m√°quina local para testes.

### Pr√© requisitos

* Necess√°rio ter o **MySQL** instalado na m√°quina para executar o projeto.

Antes de criar o banco de dados, ser√° preciso informar `username` e `password` no arquivo
`application.yml` em `src/main/resource`. As linhas a serem alteradas:

```properties
datasource:
url:jdbc:mysql://localhost:3306/ioasyschallenge
username:root
password:123456
```

Como o projeto usa o **Flyway** tamb√©m √© necess√°rio alterar os dados de login no banco, no arquivo `flyway.properties`
em `ioasys_challenge`. As linhas a serem alteradas:

```properties
flyway.user:root
flyway.password:123456
```

## Inicie a aplica√ß√£o usando uma IDE (Intellij)

* Fa√ßa o download ou clone desse reposit√≥rio.
* Abra o terminal e mude (cd) para a pasta que cont√™m o pom.xml
* Abra o Intellij ou Eclipse e selecione a pasta do projeto que cont√™m o arquivo pom.xml
* Abra o arquivo Spring Boot Application file (procure por @IoasyschallengeApplication)
* D√™ um clique com o bot√£o direito e d√™ um Run

## Acessando endpoint de autentica√ß√£o

Para obter o token e acessar os demais endpoints protegidos deve:

* Acessar o endpoint **http://localhost:8080/authenticate** informando no body

```json
{
  "username": "ioasys",
  "password": "password"
}
```

Um json ser√° informado no body, segue exemplo:

```json
{
  "token": "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJpb2FzeXMiLCJleHAiOjE2MTQ5MzIyODksImlhdCI6MTYxNDkxNDI4OX0.0IEQNyr1y2YtBS6FTnEdTcLDViXiW18igzMxhlELNGSA5Nokv9uNOFTT249yoLfwpjKULK694K67s2Il4Lj4iw"
}
```

Informando esse token no campo Authorization de uma requisi√ß√£o dar√° acesso aos endpoints protegidos.

## Acessando swagger

* URL para acessar o **SWAGGER-UI**: http://localhost:8080/swagger-ui.html

## To-Do

<ul>
  <li>[ ] Finalizar autentica√ß√£o via JWT, com os perfis de Administrador e Usu√°rio</li>
  <li>[ ] Retornar usu√°rios n√£o administradores por pagina√ß√£o</li>
  <li>[ ] Implementar vota√ß√£o para os filmes</li>
  <li>[ ] Retornar registros paginados para filmes</li>
  <li>[ ] Retornar lista ordenada de filmes mais votados em ordem alfab√©tica</li>
  <li>[ ] Detalhes do filme</li>
</ul>